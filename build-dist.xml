<?xml version="1.0"?>

<project name="freeguide-tv-dist">

    <import file="build-build.xml"/>

    <target name="dist-init">
        <mkdir dir="${dist}"/>
        <mkdir dir="${dist-repo}"/>
        <mkdir dir="${dist-rpm}"/>
    </target>
    
    <target name="dist-repository" depends="build-all, dist-init">
        
        <zip destfile="${dist-repo}/package-${application-id}-${application-version}.zip" 
    		basedir="build/package/${application-id}"/>
        
        <antcall target="all-plugins">
            <param name="actual-target" value="dist-repository-one-plugin"/>
        </antcall>
        
    </target>
    
    <target name="dist-repository-one-plugin">
    	<zip destfile="${dist-repo}/package-${plugin-id}-${plugin-version}.zip" 
    		basedir="build/package/${plugin-id}"/>
	</target>
 
    <target name="dist-clean">
        <delete dir="${dist}" />
    </target>
    
	
	
	<target name="dist-tgz" depends="build-all">
		<mkdir dir="${dist}/tgz"/>
		<tar longfile="gnu"
			 destfile="${dist}/tgz/${application-id}-${application-version}.tar.gz" compression="gzip" >
            <tarfileset dir="${build}/package/${application-id}" prefix="/usr/share/freeguide/">
	            <exclude name="doc/**"/>
            </tarfileset>
            <tarfileset dir="${build}/package/${application-id}/doc" prefix="/usr/share/doc/freeguide/"/>
        </tar>
		<antcall target="all-plugins">
            <param name="actual-target" value="subtask-dist-tgz-plugin"/>
		</antcall>
	</target>
	
	
	<target name="subtask-dist-tgz-plugin">
		<mkdir dir="${dist}/tgz"/>
		<tar longfile="gnu"
			 destfile="${dist}/tgz/${plugin-id}-${plugin-version}.tar.gz" compression="gzip" >
            <tarfileset dir="${build}/package/${plugin-id}" prefix="/usr/share/freeguide/">
	            <exclude name="doc/**"/>
            </tarfileset>
            <!--tarfileset dir="${build}/package/${plugin-id}/doc" prefix="/usr/share/doc/freeguide/"/-->
        </tar>
	</target>
    

    

</project>

