<?xml version="1.0"?>

<project name="freeguide-tv-install-linux">

    <target name="install-linux-base" depends="build-all" >
        
        <!-- These properties are passed in (example values shown):
            install_share_dir = ~/.rpm/tmp/freeguide-0.8.2-root/usr/share
            install_bin_dir   = ~/.rpm/tmp/freeguide-0.8.2-root/usr/bin
            install_doc_dir   = ~/.rpm/tmp/freeguide-0.8.2-...usr/doc/freeguide
            install_real_dir = /usr/share/freeguide
            install_real_doc_dir = /usr/doc/freeguide
        -->
        
        <property name="install_jar_dir" location="${install_share_dir}/freeguide" />

        <property name="install_pixmap_dir" location="${install_share_dir}/pixmaps/freeguide" />
        
        <mkdir dir="${install_jar_dir}" />
        
        <copy file="${build}/startup.jar" todir="${install_jar_dir}/" />
        <copy file="${build}/lib/freeguide.jar" todir="${install_jar_dir}/" />
        <copy file="${build}/lib/common.jar" todir="${install_jar_dir}/" />
        <copy file="${build}/lib/tagsoup-1.0rc3.jar" todir="${install_jar_dir}/" />

        <!-- Copy the different-sized icons to the freeguide pixmaps dir -->
        <mkdir dir="${install_pixmap_dir}" />
        <copy todir="${install_pixmap_dir}/" >
            <fileset dir="${src}/install/linux/icons" />
        </copy>
        
        <copy tofile="${install_share_dir}/pixmaps/freeguide.png" 
            file="${src}/install/linux/icons/logo-32x32.png" />
            
        <!-- Creating the launch script: first we need to copy the source launch script, then we replace the string "__ANT_DOC_DIRECTORY__" with the docs directory, and then we move it into place and make it executable. -->
        <copy file="${src}/install/linux/freeguide" tofile="${src}/install/linux/freeguide.tmp" />
        <replace file="${src}/install/linux/freeguide.tmp" token="__ANT_DOC_DIRECTORY__" value="${install_real_doc_dir}" />
        <replace file="${src}/install/linux/freeguide.tmp" token="__ANT_INSTALL_DIRECTORY__" value="${install_real_dir}" />
        <mkdir dir="${install_bin_dir}" />
        <move file="${src}/install/linux/freeguide.tmp" tofile="${install_bin_dir}/freeguide" />
        <chmod file="${install_bin_dir}/freeguide" perm="a+x" />
        
        <mkdir dir="${install_share_dir}/applications" />
        <copy file="${src}/install/linux/freeguide.desktop" todir="${install_share_dir}/applications/" />

        <mkdir dir="${install_share_dir}/man/man1" />
        <copy file="${build}/freeguide.1.gz" todir="${install_share_dir}/man/man1/" />
        
        <mkdir dir="${install_doc_dir}" />
        <copy todir="${install_doc_dir}/">
            <fileset dir="${doc}">
                <include name="*.html" />
                <include name="*.png" />
                <include name="*.css" />
                <include name="COPYING" />
                <include name="TODO" />
                <exclude name="bugreport.html" />
            </fileset>
        </copy>
        
    </target>
    
    <target name="install-linux-all" >
        <mkdir dir="${install_share_dir}" />
            <copy file="${doc}/freeguide-all.empty" todir="${install_share_dir}/freeguide/"/>
    </target>
    
    <target name="install-linux-plugin" depends="build-all">
        
        <!-- These properties are passed in (example values shown):
            install_share_dir = ~/.rpm/tmp/freeguide-0.8.2-root/usr/share
            install_doc_dir   = ~/.rpm/tmp/freeguide-0.8.2-...usr/doc/freeguide
            install_real_doc_dir = /usr/doc/freeguide
            plugin_name = grabber-cosmostv
        -->
        
        <mkdir dir="${install_share_dir}/freeguide/plugins/" />
        <copy file="${build}/lib/${plugin_name}.jar" todir="${install_share_dir}/freeguide/plugins/" />
    </target>
    
    <target name="install-linux-clean"/>
    
</project>

