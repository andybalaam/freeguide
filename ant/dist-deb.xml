<?xml version="1.0"?>

<project name="freeguide-tv-dist-deb" default="dist-deb">

    <!-- To run this:
    sudo apt-get install devscripts lintian
    -->

    <import file="compile.xml"/>
    <import file="dist-src.xml"/>
    <import file="plugins-info.xml"/>

    <target name="dist-deb" depends="prepare,dist-src">

        <property name="name-ver" value="${application-id}-${application-version}"/>
        <property name="name_ver" value="${application-id}_${application-version}"/>

        <property name="build-deb" value="${build}/install/linux/deb"/>
        <property name="app-name-ver" value="${application-id}_${application-version}"/>

        <delete dir="${build-deb}"/>
        <mkdir dir="${build-deb}"/>

        <copy file="${dist-src}/${name-ver}.tar.gz" tofile="${build-deb}/${name_ver}.orig.tar.gz"/>

        <gunzip src="${build-deb}/${name_ver}.orig.tar.gz"/>
        <untar src="${build-deb}/${name_ver}.orig.tar" dest="${build-deb}"/>

        <copy todir="${build-deb}/${name-ver}/debian">
            <fileset dir="${install}/linux/debian"/>
        </copy>

        <exec dir="${build-deb}/${name-ver}" executable="debuild" resolveexecutable="true" failonerror="true"/>

        <mkdir dir="${dist-deb}"/>
        <move todir="${dist-deb}">
            <fileset dir="${build-deb}">
                <include name="*.deb"/>
            </fileset>
        </move>

    </target>

</project>


